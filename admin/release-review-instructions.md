Reviewing a Log4cxx release
===================

The review should confirm the uploaded source code is not corrupt and
is identical to the package generated by the Github action.
The steps below use version 1.6.2 as an example.

Prerequisites
----------

* A C++ compiler is available on your system
* cmake, APR and APR-Util are installed on your system
* [GNU Privacy Guard](https://www.gnupg.org/) is installed on your system
* You have imported the [Apache Logging KEYS file](https://dist.apache.org/repos/dist/release/logging/KEYS)

Additional Prerequisites (Windows only)
----------

* The `PATH` environment variable includes directories containing `cmake.exe` and `gpg.exe`
* One of these environment variables is set (using / directory separators):
  - `CMAKE_TOOLCHAIN_FILE` - The full path to the `vcpkg.cmake` file (where APR-Util is installed)
  - `CMAKE_INSTALL_PREFIX` - The full path to the directory where EXPAT, APR and APR-Util libraries are installed (they can be built using [these instructions](https://logging.staged.apache.org/log4cxx/build-cmake.html#Windows))
* If the programs `zip.exe`, `gzip.exe` and `sed.exe` are not in `C:\msys64\usr\bin`, the environment has a variable `LOG4CXX_TEST_PROGRAM_PATH` set to the full path (using / directory separators) containing those programs

Steps
-----

1. Download, verify check-sums, verify signatures, build and test
    - Save to your system a verification script from https://github.com/apache/logging-log4cxx/blob/master/admin
      - Linux, MacOS: `validate-release.sh`
      - Windows: `validate-release.ps1`
    - Run the script
      - Linux, MacOS:
        - `sh validate-release.sh 1.6.2`
      - Windows:
        - `.\validate-release.ps1 1.6.2`
    - For success, the final output line needs to include:
        - `100% tests passed, 0 tests failed out of 63`
1. Download the packaged release files from Github
    - Open https://github.com/apache/logging-log4cxx/commits/v1.6.1-RC1 in your web browser
    - Click the green tick mark on the top commit
        - The `All checks have passed` pop-up window will display
    - Click the "Details" link on the row next to `Generate release files / Package code for release`
        - The `Package for release` log window will display
    - Click the `>` to the left of `Run action/upload-artifact`
        - The numbered steps will display
    - Click the link next to `Artifact download URL:`
        - The browser will download the file `release_files.zip` onto your system
1. Confirm the artifacts were sourced from Github using these commands
    - Linux, MacOS (bash):
      - `cd /tmp/log4cxx-1.6.2`
      - `unzip $HOME/Downloads/release_files.zip -d github`
      - `ARCHIVE=apache-log4cxx-1.6.2`
      - `for TYPE in tar.gz zip; do`
      - `diff {,github/}$ARCHIVE.$TYPE.sha512 && echo "$ARCHIVE.$TYPE.sha512: OK"`
      - `done`
    - Windows (powershell):
      - `Set-Location -Path "${ENV:TEMP}\log4cxx-1.6.2"`
      - `Expand-Archive -Path "${ENV:HOMEPATH}\Downloads\release_files.zip" -DestinationPath "github"`
      - `$ARCHIVE="apache-log4cxx-1.6.2"`
      - `foreach ($TYPE in @("tar.gz", "zip")) {`
      - `` if (@(Get-Content -Path "$ARCHIVE.$TYPE.sha512")[0]` ``
      - `-eq @(Get-Content -Path "github\$ARCHIVE.$TYPE.sha512")[0]) {`
      - `Write-Output "$ARCHIVE.$TYPE.sha512: OK" } }`

